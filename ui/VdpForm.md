# VdpForm component API

## Properties

- **`pgp-keys`** (Array) [Required]
  - **Description**: Array of PGP public keys. Each entry must be an object with 2 properties : 'name' containing the name to be displayed and 'key' containing the PGP key
  - **Example**:
    - `[{"name":"Key 1","key":"-----BEGIN PGP PUBLIC KEY BLOCK-----\n..."},{"name":"Key 2","key":"-----BEGIN PGP PUBLIC KEY BLOCK-----\n..."}]`
- **`captcha-provider`** (Function)
  - **Description**: Provider of the captcha data (async function)
  - **Function form**: `() => Object`
  - **Returns** Object:
    - **Description**: Captcha data
    - **Props**:
      - **`key`** (String) [Required]
        - **Description**: Unique key identifying this captcha data
        - **Example**:
          - `8ec3d9f8c7fb0caa15f7edc6630c803d`
      - **`url`** (String) [Required]
        - **Description**: URL of the captcha image
        - **Examples**:
          - `data:image/jpeg;base64:...`
          - `https://backend/captcha-8ec3d9f8c7fb0caa15f7edc6630c803d.jpeg`
      - **`width`** (Number)
        - **Description**: Width of the captcha image in pixels
        - **Example**:
          - `300`
      - **`height`** (Number)
        - **Description**: Height of the captcha image in pixels
        - **Example**:
          - `64`
- **`attachment-max-size-bytes`** (Number)
  - **Description**: Maximum size of individual attachments, in bytes
  - **Default value**: `2097152`
- **`attachment-allowed-extensions`** (Array)
  - **Description**: A list of allowed extension for attachments
  - **Default value**: `['jpg', 'jpeg', 'png', 'txt']`
  - **Example**:
    - `['txt', 'png', 'jpg']`
- **`notifications-position`** (String)
  - **Description**: Default position for notifications
  - **Accepted values**: `top-left` | `top-right` | `bottom-left` | `bottom-right` | `top` | `bottom` | `left` | `right` | `center`
  - **Default value**: `top`
- **`success-notification-position`** (String)
  - **Description**: Position for success notification. Inherits from 'notifications-position' if not set
  - **Accepted values**: `top-left` | `top-right` | `bottom-left` | `bottom-right` | `top` | `bottom` | `left` | `right` | `center`
- **`errors-notification-position`** (String)
  - **Description**: Position for errors notification. Inherits from 'notifications-position' if not set
  - **Accepted values**: `top-left` | `top-right` | `bottom-left` | `bottom-right` | `top` | `bottom` | `left` | `right` | `center`
- **`disclosure-policy-notification-position`** (String)
  - **Description**: Position for disclosure policy notification. Inherits from 'notifications-position' if not set
  - **Accepted values**: `top-left` | `top-right` | `bottom-left` | `bottom-right` | `top` | `bottom` | `left` | `right` | `center`

## Events

- **@submit** -> function(`payload`, `success`, `failure`)
  - **Description**: Emitted when the report is submitted ; one of 'success' or 'failure' callback MUST be called after receiving this event, on the component will stop to behave correctly.
  - **Parameters**:
    - **`payload`** (Object)
      - **Description**: The content of the report
      - **Props**:
        - **`captcha`** (Object)
          - **Description**: Captcha answer data (if captcha-provider provided)
          - **Props**:
            - **`key`** (String)
              - **Description**: Unique key identifying the captcha, as given by the captcha-provider
            - **`value`** (String)
              - **Description**: Captcha answer given by the reporter
        - **`report`** (Object)
          - **Description**: The report
          - **Props**:
            - **`title`** (String)
              - **Description**: The title of the report
            - **`product`** (String)
              - **Description**: The product affected by the vulnerability
            - **`cvss`** (Object)
              - **Description**: CVSS3 metrics
              - **Props**:
                - **`AV`** (string)
                  - **Description**: Attack Vector
                  - **Accepted values**: `N` | `A` | `L` | `P`
                - **`AC`** (string)
                  - **Description**: Attack Complexity
                  - **Accepted values**: `L` | `H`
                - **`PR`** (string)
                  - **Description**: Privileges Required
                  - **Accepted values**: `N` | `L` | `H`
                - **`S`** (string)
                  - **Description**: Scope
                  - **Accepted values**: `U` | `C`
                - **`A`** (string)
                  - **Description**: Availability
                  - **Accepted values**: `N` | `L` | `H`
                - **`I`** (string)
                  - **Description**: Integrity
                  - **Accepted values**: `N` | `L` | `H`
                - **`C`** (string)
                  - **Description**: Confidentiality
                  - **Accepted values**: `N` | `L` | `H`
                - **`UI`** (string)
                  - **Description**: User Interaction
                  - **Accepted values**: `N` | `R`
            - **`cvss_score`** (Number)
              - **Description**: Score of the CVSS
            - **`pgp_data`** (String)
              - **Description**: A PGP-encrypted ZIP archive containing the report's sensitive data (description, attachments, reporter information, ...)
            - **`hash_algorithm`** (string)
              - **Description**: The hash algorithm used to create the 'digest' of the ZIP archive before encryption
            - **`digest_hex`** (string)
              - **Description**: The hash of the ZIP archive generated by the 'hash_algorithm' before encryption
    - **`success`** (Function)
      - **Description**: A callback to call if the report has been handled successfully
      - **Function form**: `(message) => void 0`
      - **Params**:
        - **`message`** (String)
          - **Description**: The success message
    - **`failure`** (Function)
      - **Description**: A callback to call if handling the report has failed
      - **Function form**: `(message) => void 0`
      - **Params**:
        - **`message`** (String)
          - **Description**: The failure message
